package game.entity;

import java.awt.Rectangle;

import game.Game;
import game.render.textures.Animation;
import game.render.textures.Texture;
import game.utils.init.InitAnimations;
import game.world.TileMap;

public class EntityBoop extends Mob {
	
	private double displacement;
	private double speed;
	private double spawnPointX;
	private boolean dead;
	private boolean displaced;
	private Animation currentState;

	public EntityBoop(Texture texture, double x, double y, TileMap tileMap, Rectangle AABB, double speed, double displacement) {
		super(texture, x, y, tileMap, AABB);
		this.motionX = speed;
		this.speed = speed;
		this.spawnPointX = x;
		this.displacement = displacement;
		this.currentState = InitAnimations.animations.get("Boop_Walk");
	}

	@Override
	public void setDead() {
		//this.AABB = null;
/*		this.texture = null;
		tileMap.killEntity(this);*/
		dead = true;
		this.x = -100;
		AABB.setLocation((int)x, (int)y);
		System.out.println("ded");
	}
	
	@Override
	public void tick() {
		if (!dead) {
			if (Math.abs(x - spawnPointX) > displacement || displaced) {
				this.motionX = -motionX;
				this.speed = -speed;
				displaced = false;
			}
			currentState.run();
			super.tick();
		}
	}
	
	public void onHit(Player player) {
		player.setDead();
	}
	
	public void onKillHit(Player player) {
		player.setMotionY(-10.0);
		Game.fxmanager.playSound("BoopDeath");
		player.score();
		this.setDead();
	}
	
	@Override
	public void move() {

		if(tileMap.calculateNPCCollision(this, x, y, motionX, motionY)) {
			motionX = -speed;
			speed = -speed;
		}  
		y+= getMotionY();
		x+= getMotionX();
	}
}
